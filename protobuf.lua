function protobufs(pat)    local list = {}    if type(pat) == "string" then        list[1] = pat;    elseif type(pat) == "table" then        list = pat;    end    for _,pat in ipairs(list) do        local protofiles = os.matchfiles(pat);        local proj = project();        if #protofiles > 0 then            includedirs { proj.basedir.."/build/proto" }        end        for _,protofile in ipairs(protofiles) do            local sourcedir = proj.basedir.."/"..path.getdirectory(protofile);            local sourcefile = proj.basedir.."/"..protofile;            local targetdir = proj.basedir.."/build/proto/"..path.getdirectory(protofile);            local targetfile = targetdir.."/"..path.getbasename(protofile)..".pb.cc";            prebuildcommands {                "@mkdir -p "..targetdir,                "@if [ "..sourcefile.." -nt "..targetfile.." ]; then \\\n"                .."\techo protoc "..protofile.."; \\\n"                .."\tprotoc --cpp_out "..targetdir.." "..sourcefile.." -I"..sourcedir.."; \\\n"                .."fi"            }            files { proj.basedir.."/build/proto/"..path.getbasename(protofile)..".pb.*" }        end    endend